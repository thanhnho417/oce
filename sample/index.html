<!DOCTYPE html>
<html>
<head>
  <title>Video.js với Watermark Trên Video</title>
  <link href="https://vjs.zencdn.net/7.15.4/video-js.css" rel="stylesheet">
  <style>
    /* Container chính */
    .video-container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    
    /* Custom Watermark Styles */
    .vjs-watermark {
      position: absolute;
      right: 10px;
      bottom: 10px;
      width: 80px;
      z-index: 2;
      pointer-events: none;
      opacity: 0.7;
      transition: opacity 0.3s;
    }
    
    .vjs-watermark img {
      width: 100%;
      height: auto;
    }
    
    /* Đảm bảo video container có position relative */
    .video-js {
      position: relative;
    }
  </style>
</head>
<body>
  <div class="video-container">
    <video id="my-video" class="video-js vjs-16-9" controls preload="auto" data-setup='{}'>
      <source src="https://raw.githubusercontent.com/thanhnho417/up/refs/heads/main/assets/The%20Apothecary%20Daries/videos/s2/ep15/tad-s2-ep15.m3u8" type="application/x-mpegURL">
      <p class="vjs-no-js">
        Trình duyệt không hỗ trợ HTML5 video
      </p>
    </video>
  </div>

  <script src="https://vjs.zencdn.net/7.15.4/video.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const player = videojs('my-video');
      
      player.ready(function() {
        // Tạo watermark
        var watermark = document.createElement('div');
        watermark.className = 'vjs-watermark';
        watermark.innerHTML = '<img src="https://raw.githubusercontent.com/thanhnho417/up/refs/heads/main/images/watermark.png">';
        
        // Thêm vào player
        player.el().appendChild(watermark);
        
        // Hàm cập nhật vị trí
        function updateWatermarkPosition() {
          const tech = player.tech_.el();
          if (!tech.videoWidth) return;
          
          const videoRatio = tech.videoWidth / tech.videoHeight;
          const containerRatio = tech.offsetWidth / tech.offsetHeight;
          const margin = 10;
          
          if (containerRatio > videoRatio) {
            // Có viền đen trên dưới
            const videoHeight = tech.offsetWidth / videoRatio;
            const offset = (tech.offsetHeight - videoHeight) / 2;
            watermark.style.bottom = offset + margin + 'px';
          } else {
            // Có viền đen trái phải hoặc vừa khít
            watermark.style.bottom = margin + 'px';
          }
          
          watermark.style.right = margin + 'px';
        }
        
        // Cập nhật vị trí ban đầu
        updateWatermarkPosition();
        
        // Theo dõi các sự kiện thay đổi kích thước
        player.on('resize', updateWatermarkPosition);
        player.on('loadedmetadata', updateWatermarkPosition);
        
        // Kiểm tra khi fullscreen
        player.on('fullscreenchange', function() {
          setTimeout(updateWatermarkPosition, 100);
        });
      });
    });
  </script>
</body>
</html>